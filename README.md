# ๐ ะกะธััะตะผะฐ ะฐะฒัะพะผะฐัะธะทะธัะพะฒะฐะฝะฝะพะน ะฒัะณััะทะบะธ ะดะฐะฝะฝัั ะธ ะพััะตัะฝะพััะธ ะธะท SR-bank

โ **ะะฐะทะฝะฐัะตะฝะธะต ะฟัะพะตะบัะฐ**
ะะฐะฝะฝัะน ะฟัะพะตะบั ะฐะฒัะพะผะฐัะธะทะธััะตั ะฟัะพัะตัั ะฟะพะปััะตะฝะธั ะดะฐะฝะฝัั ะธะท ะฑะฐะทั ะดะฐะฝะฝัั **Oracle**,
ะพะฑัะฐะฑะพัะบะธ ัะตะทัะปััะฐัะพะฒ ะธ ัะพัะผะธัะพะฒะฐะฝะธั Excel-ะพััะตัะพะฒ.

ะัะพะตะบั ะธะฝัะตะณัะธััะตััั ั **Excel ัะตัะตะท xlwings** ะธ ะผะพะถะตั ะฒัะทัะฒะฐัััั ะฟััะผะพ ะธะท ะบะฝะธะณะธ Excel.

---

## ๐ ะััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ

```
Get_data_SR/
โโโ main.py                  # ะะปะฐะฒะฝัะน ะฒัะพะด: ะฝะฐะฑะพั ััะฝะบัะธะน-ะทะฐะฟััะบะฐัะตะปะตะน
โ
โโโ db/                      # ะะพะดัะปะธ ะดะปั ะฟะพะดะบะปััะตะฝะธั ะบ ะะ Oracle
โ   โโโ connect_db_oracle.py # ะะพะณะธะบะฐ ัะพะตะดะธะฝะตะฝะธั
โ   โโโ oracle.py            # ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ะผะตัะพะดั ัะฐะฑะพัั ั Oracle
โ
โโโ fetchers/                # ะะพะดัะปะธ-ะทะฐะณััะทัะธะบะธ ะดะปั ัะฐะทะฝัั ะพััะตัะพะฒ
โ   โโโ balance_nrk.py       # ะัะพะณะฝะพะทะฝัะน ะฑะฐะปะฐะฝั ะดะปั ะัะบ
โ   โโโ diff_acc.py          # ะะธะฝะฐะผะธะบะฐ ะพััะฐัะบะพะฒ ะฟะพ ััะตัะฐะผ
โ   โโโ doc_acc.py           # ะะพะบัะผะตะฝัั ะฟะพ ะทะฐะดะฐะฝะฝะพะผั ััะตัั
โ   โโโ dz_spot.py           # ะกะดะตะปะบะธ ะฟะพ ะะ ะธ ะกะะะข
โ   โโโ dz_spot_diff.py      # ะะธะฝะฐะผะธะบะฐ ะฟะพ ะะ ะธ ะกะะะข
โ   โโโ fz_ccf_6jx.py        # ะััะตั ะฟะพ ัะธะฝ.ะพะฑัะทะฐั. (9 ะบะป.) ะดะปั 6JX
โ   โโโ grp_9000.py          # ะัะณััะทะบะฐ 900% ะธ 9129 ะดะปั ะัะบ
โ   โโโ secur_doc.py         # ะฆะตะฝะฝัะต ะฑัะผะฐะณะธ โ ัะดะตะปะบะธ
โ
โโโ sql/                     # SQL-ัะฐะฑะปะพะฝั ะดะปั ะทะฐะฟัะพัะพะฒ
โ   โโโ SR_6JX_FZ_CCF_template.sql      # ะัะณััะทะบะฐ ะดะฐะฝะฝัั ัะธะฝ.ะพะฑัะทะฐั. (9 ะบะป.) ั CCF ะดะปั 6JX
โ   โโโ SR_BALANCE_NRK_template.sql     # ะัะณััะทะบะฐ ะดะฐะฝะฝัั ะฑะฐะปะฐะฝัะฐ ะดะปั ะัะบ
โ   โโโ SR_CHECK_9000_template.sql      # ะัะณััะทะบะฐ ะดะฐะฝะฝัั 900% ะธ 9129 ะดะปั ะัะบ
โ   โโโ SR_CHECK_DZ_SPOT_template.sql   # ะัะณััะทะบะฐ ะดะฐะฝะฝัั ะฟะพ ะะ ะธ ะกะะะข
โ   โโโ SR_DIFF_ACC_template.sql        # ะัะณััะทะบะฐ ะดะฐะฝะฝัั ะฟะพ ะดะธะฝะฐะผะธะบะฐ ะพััะฐัะบะพะฒ ะฟะพ ััะตัะฐะผ
โ   โโโ SR_DIFF_DZ_SPOT_template.sql    # ะัะณััะทะบะฐ ะดะฐะฝะฝัั ะฟะพ ะะ ะธ ะกะะะข
โ   โโโ SR_DOC_ACC_template.sql         # ะัะณััะทะบะฐ ะดะฐะฝะฝัั ะฟะพ ะดะพะบัะผะตะฝัะฐะผ ะทะฐะดะฐะฝะฝะพะณะพ ััะตัะฐ
โ   โโโ SR_SECUR_DOC_template.sql       # ะัะณััะทะบะฐ ะดะฐะฝะฝัั ะฟะพ ัะดะตะปะบะฐะผ ะฆะ
โ
โโโ utils/                   # ะัะฟะพะผะพะณะฐัะตะปัะฝัะต ะผะพะดัะปะธ
โ   โโโ date_utils.py        # ะะฐะฑะพัะฐ ั ะดะฐัะฐะผะธ
โ   โโโ excel_writer.py      # ะญะบัะฟะพัั ะฒ Excel
โ   โโโ path_utils.py        # ะััะธ ะธ ะดะธัะตะบัะพัะธะธ
โ
โโโ watcher/                 # ะะพะดัะปะธ ะดะปั ะผะพะฝะธัะพัะธะฝะณะฐ ัะฐะนะปะพะฒ STAT ะฝะฐ ัะตัะตะฒัั ะดะธัะบะฐั
โ   โโโ check_copy_v1.py     # ะะฐะทะพะฒะฐั ะฒะตััะธั ะผะพะฝะธัะพัะธะฝะณะฐ
โ   โโโ check_copy_v2.py     # ะะฐััะธัะตะฝะฝะฐั ะฒะตััะธั ะผะพะฝะธัะพัะธะฝะณะฐ
```

---

## โ ะฃััะฐะฝะพะฒะบะฐ

ะฃััะฐะฝะพะฒะบะฐ ะธ ะธัะพะปัะทะพะฒะฐะฝะธะต ัะตะฐะปะธะทัะตััั ัะตัะตะท **conda** v25.5.1

ะะฟะตัะฐัะธะธ ะฟะพัะปะต ัััะฐะฝะพะฒะบะธ **conda**:

1. **ะัะบะปััะธัั ะฟัะพะฒะตัะบั SSL ัะตัะตะท ัะตัะผะธะฝะฐะป conda**
```bash
conda config --set ssl_verify false
#ะัะพะฒะตัะบะฐ:
conda config --show ssl_verify
```

2. **ะะพะฑะฐะฒะปะตะฝะธะต ะฟัะพะบัะธ ะดะปั HTTP**
```bash
conda config --set proxy_servers.http http://inetsvc.radabank.com.ua:8080
conda config --set proxy_servers.https http://inetsvc.radabank.com.ua:8080
#ะัะพะฒะตัะบะฐ ะธัะพะณะพะฒัั ะฝะฐัััะพะตะบ
conda config --show proxy_servers
```

3. **ะะฐัััะพะนะบะฐ ะพัะฝะพะฒะฝะพะณะพ ะบะฐะฝะฐะปะฐ conda-forge:**
```bash
conda config --add channels conda-forge
conda config --set channel_priority strict
#ะัะพะฒะตััะตะผ ัะตะบััะธะต ะบะฐะฝะฐะปั:
conda config --show channels
```

4. **ะัะพะฒะตัะบะฐ ะบะพััะตะบัะฝะพััะธ ัััะฐะฝะพะฒะบะธ Python:**
```bash
python --version
conda --version
conda list
```

5. **ะฃััะฐะฝะพะฒะบะฐ Spyder ั ะฟะพะปะฝัะผ ะฝะฐะฑะพัะพะผ ัะฐััะธัะตะฝะธะน:**
```bash
conda install spyder spyder-kernels qtpy pyqt
```

6. **ะฃััะฐะฝะพะฒะบะฐ Jupyter Notebook, JupyterLab ะธ ัะฐััะธัะตะฝะธะน**
```bash
conda install notebook jupyterlab jupyterlab-language-pack-ru-RU jupyterlab_widgets ipywidgets
jupyter_contrib_nbextensions
jupyter contrib nbextension install --user
jupyter nbextensions_configurator enable --user
pip install spyder-notebook
```

7. **ะฃััะฐะฝะพะฒะบะฐ xlwings ัะตัะตะท conda**
```bash
conda install xlwings
conda list xlwings
setx XLWINGS_LICENSE_KEY noncommercial
xlwings addin install
```

```python
#ะขะตััะพะฒัะน ัะบัะธะฟั
import xlwings as xw
app = xw.App(visible=True)
wb = app.books.add()
wb.sheets[0]['A1'].value = "ะขะตัั xlwings โ ะฒัe ัะฐะฑะพัะฐะตั!"
```

8. **ะฃััะฐะฝะพะฒะธัั ะทะฐะฒะธัะธะผะพััะธ**
ะ ะฟัะพะตะบัะต ะธัะฟะพะปัะทััััั ัะปะตะดัััะธะต ะพะฑัะทะฐัะตะปัะฝัะต ะฒะฝะตัะฝะธะต ะทะฐะฒะธัะธะผะพััะธ:
- `oracledb` โ ะฟะพะดะบะปััะตะฝะธะต ะบ ะฑะฐะทะต ะดะฐะฝะฝัั Oracle
- `pandas` โ ะพะฑัะฐะฑะพัะบะฐ ัะฐะฑะปะธัะฝัั ะดะฐะฝะฝัั
- `pywin32` โ ะดะพัััะฟ ะบ ัะธัะพะบะพะผั ัะฟะตะบััั ััะฝะบัะธะน Windows API ะธ ะบะพะผะฟะพะฝะตะฝัะฐะผ COM (Component Object Model) ะธะท Python

*ะะฟัะธะพะฝะฐะปัะฝะพ:*
- `numpy` โ ะฟะพะดะดะตัะถะบั ะผะฝะพะณะพะผะตัะฝัั ะผะฐััะธะฒะพะฒ ะธ ะผะฐััะธั, ะฐ ัะฐะบะถะต ัะธัะพะบะธะน ะฝะฐะฑะพั ะฒััะพะบะพััะพะฒะฝะตะฒัั ะผะฐัะตะผะฐัะธัะตัะบะธั ััะฝะบัะธะน
- `matplotlib` โ ะดะปั ะฒะธะทัะฐะปะธะทะฐัะธะธ ะดะฐะฝะฝัั

```bash
conda install pandas oracledb pywin32 numpy matplotlib
```

9. **ะะฐัััะพะนะบะฐ ะฟะพะดะบะปััะตะฝะธั ะบ Oracle**
ะ ะผะพะดัะปะต `db/connect_db_oracle.py` ะฐะฒัะพัะธะทะฐัะธั ะบ ะฑะฐะทะต Oracle ัะตะฐะปะธะทะพะฒะฐะฝะฐ ัะตัะตะท ะบะพะฝัะธะณััะฐัะธะพะฝะฝัะน JSON-ัะฐะนะป, ัะฐัะฟะพะปะพะถะตะฝะฝัะน ั ะฟะพะปัะทะพะฒะฐัะตะปั ะฟะพ ะฟััะธ:
`~\.conda\db_ac.json`

๐ ะคะพัะผะฐั **db_ac.json**

```json
{
    "user": "ะะะจ_ะะะะะ",
    "password": "ะะะจ_ะะะะะะฌ",
    "dsn": "RB-RDB1.radabank.com.ua:1521/srbank"
}
```
๐ *ะัะพะฑะตะฝะฝะพััะธ:*
ะคะฐะนะป ะดะพะปะถะตะฝ ะฑััั ัะพะทะดะฐะฝ ะธ ะพะฑะฝะพะฒะปัะฝ ัะฐะผะธะผ ะฟะพะปัะทะพะฒะฐัะตะปะตะผ.

ะััั ัะพัะผะธััะตััั ัะตัะตะท `os.path.expanduser`, ััะพ ะณะฐัะฐะฝัะธััะตั ะฟัะฐะฒะธะปัะฝะพะต ะพะฟัะตะดะตะปะตะฝะธะต ะดะพะผะฐัะฝะตะน ะดะธัะตะบัะพัะธะธ ะฝะตะทะฐะฒะธัะธะผะพ ะพั ัะธััะตะผั.

ะะฒัะพัะธะทะฐัะธั ะฟัะพะธััะพะดะธั ะฒ Thin Mode Oracle, ััะพ ะฝะต ััะตะฑัะตั ัััะฐะฝะพะฒะบะธ ะฟะพะปะฝะพะน Oracle Client.

๐ *ะะพะณะธะบะฐ:*
ะะฟัะตะดะตะปัะตััั ะฟััั ะบ `~\.conda\db_ac.json`.

ะะฐะณััะถะฐัััั ััะตัะฝัะต ะดะฐะฝะฝัะต (user, password, dsn) ะฒ ัะปะพะฒะฐัั.

ะัะฟะพะปะฝัะตััั ะฟะพะดะบะปััะตะฝะธะต ัะตัะตะท `oracledb.connect(...)`.

ะัะธ ััะฟะตัะฝะพะผ ะฟะพะดะบะปััะตะฝะธะธ ะฒัะฒะพะดะธััั ัะพะพะฑัะตะฝะธะต "โ Connected using JSON config in .conda".

---

## ๐ ะะฐะฟััะบ

### ๐ ะงะตัะตะท Python
```bash
python main.py
```
ะธะปะธ ะฒัะทะพะฒ ะพัะดะตะปัะฝัั ััะฝะบัะธะน:
```python
from main import run_secur_doc, run_balance_nrk

run_balance_nrk()
```

### ๐ ะงะตัะตะท Excel (xlwings)
- ะัะบัััั ะบะฝะธะณั Excel, ะฟัะธะฒัะทะฐะฝะฝัั ะบ ะฟัะพะตะบัั
- ะัะทัะฒะฐัั ะผะฐะบัะพัั `run_*` ะฝะฐะฟััะผัั

---

## ๐ ะะฟะธัะฐะฝะธะต ะพัะฝะพะฒะฝัั ััะฝะบัะธะน (main.py)

| ะคัะฝะบัะธั                | ะะฟะธัะฐะฝะธะต |
|------------------------|----------|
| `run_secur_doc()`      | ะัะณััะทะบะฐ ะธ ัะบัะฟะพัั ะดะฐะฝะฝัั ะฟะพ ัะตะฝะฝัะผ ะฑัะผะฐะณะฐะผ |
| `run_grp_9000()`       | ะคะพัะผะธัะพะฒะฐะฝะธะต ะพััะตัะฐ ะฟะพ ะณััะฟะฟะต 9000 |
| `run_dz_spot()`        | ะะฐะฝะฝัะต ะฟะพ DZ Spot |
| `run_balance_nrk()`    | ะะฐะปะฐะฝั ะะะ |
| `run_diff_spot()`      | ะะฐะทะฝะธัะฐ ะฟะพ ัะดะตะปะบะฐะผ DZ Spot |
| `run_forecast_mail()`  | ะัะฟัะฐะฒะบะฐ email ั ะฟัะพะณะฝะพะทะพะผ |
| `run_diff_acc()`       | ะะฐะทะฝะธัะฐ ะฟะพ ััะตัะฐะผ |
| `run_fz_ccf_6jx()`     | ะััะตั ะฟะพ FZ CCF 6JX |
| `run_doc_acc()`        | ะะพะบัะผะตะฝัั ะฟะพ ััะตัะฐะผ |

---

## ๐ ะะพะณะธะบะฐ ัะฐะฑะพัั

```
โโโโโโโโโโโโโโโโโโโ
โ  Excel / Python โ
โโโโโโโโโฌโโโโโโโโโโ
        โ ะฒัะทะพะฒ run_*
        โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ fetchers/<report>.py    โ
โ  - ะทะฐะณััะถะฐะตั SQL        โ
โ  - ะฒัะฟะพะปะฝัะตั ะทะฐะฟัะพั     โ
โ  - ะฟะพะปััะฐะตั DataFrame   โ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ utils/excel_writer.py   โ
โ  - ะทะฐะฟะธััะฒะฐะตั ะดะฐะฝะฝัะต    โ
โ    ะฒ Excel              โ
โโโโโโโโโโโฌโโโโโโโโโโโโโโโโ
          โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ mail/forecast_nrk.py    โ
โ  (ะตัะปะธ ะฝัะถะฝะพ) โ ะพัะฟัะฐะฒะบะฐโ
โ   ะฟะธััะผะฐ ั ัะตะทัะปััะฐัะพะผ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

- **ะฏะทัะบ:** Python 3.12
- **ะะ:** Oracle 19ั
- **MS Office Excel:** 2021
- **ะคะพัะผะฐั ะพััะตัะพะฒ:** Excel (.xlsx)
- **ะะฝัะตะณัะฐัะธั:** xlwings 0.33.15
---
