## Задача: формирование перечня остатков для расчета процентного риска торговой книги файла 7S

**Цель:** получить перечень остатков с параметрами для расчета процентного риска торговой книги 7S.

**Входные данные:**
- дата которая будет получена из excel и является отчетной датой
- результат отработки запроса SR_7S_INTEREST_RISK_template.sql

**Первоначальные действия:**
1. получить отчетную дату из excel из которого запущен скрипт, дата берется из именованной ячейки RDATE7SX на листе Calculation
2. передать полученные данные в запрос SR_7S_INTEREST_RISK_template.sql в переменную :date_param
3. полчить результат запроса SR_7S_INTEREST_RISK_template.sql
4. добавить к полученному датафрейму поле COUNT_DAY - логика расчета должна возвращать количестве дней как разницу между полем DATE_END минус :date_param
5. добавить к полученному датафрейму поле TENOR - данное поле рассчитывается по следующей логике:
   ЕСЛИ(TENOR<=31;"1M";TENOR<=92;"3M";TENOR<=183;"6M";TENOR<=365;"1Y";TENOR<=729;"2Y";TENOR<=1094;"3Y";TENOR<=1459;"4Y";TENOR<=1824;"5Y";TENOR<=2554;"7Y";TENOR<=3649;"10Y";TENOR<=5474;"15Y";TENOR<=7299;"20Y";TENOR="";"";ИСТИНА;"UP20Y")
6. добавить к полученному датафрейму поле SUM_CALC - данное поле расчитывается по следующей логике:
   значение поля SUM_UAH на соответствующее значение COEF в зависимости от поля TENOR
    Варианты COEF:

    TENOR	COEF
    1M	0
    3M	0.0020
    6M	0.0040
    1Y	0.0070
    2Y	0.0125
    3Y	0.0175
    4Y	0.0225
    5Y	0.0275
    7Y	0.0325
    10Y	0.0375
    15Y	0.0450
    20Y	0.0525
    UP20Y	0.0600

**Выходные данные:**
- резльтаты отработки записываются в файл excel из котрого вызван скрипт в таблицу с именем t7S_INTEREST, на листе TRAD_F01X - используй процедуру записи в таблицу paste_to_excel

**Логирование:**
- допускается формирование логов, условие - логи в случае необходимости могут быть просто отключены

**Размещение:**
- скрипт долже быть в одном модуле с именем "interest_7sx" размещай в fetchers
- лог размещай в logs

**Рекомендации:**
- для понимания структуры данных прочитай файл SR_7S_INTEREST_RISK_template
- скрипт должен быть компактным и быстрым, добавляй в код комментарии на русском
- предусмотри что бы значения с котрыми сравнивается TENOR и Варианты COEF, были доступны для удобного редактирования
- в случае возникновения вопросов или уточнения обязательно спрашивай меня