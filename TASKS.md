## Задача: формирование перечня документов для 6S

**Цель:** получить перечень покументов которые были проведены и формируют остатки для 6S.

**Входные данные:**
- Список acc_calc, который получен по результату отработки скрипта detail_6sx
- Файл: SR_6SX_PAY_template.sql - должен возвращать перечень документов которые проведены и формируют остатки для 6S.
- дата которая будет получена из excel и является отчетной датой.

**Первоначальные действия:**
1. получить отчетную дату из excel из которого запущен скрипт, дата берется из именованной ячейки RDATE на листе menu
2. из списка acc_calc получить значения полей ID и CUR
3. передать полученные данные в запрос SR_6SX_PAY_template.sql: :date_param = RDATE, :data_acc = ID, :data_cur = CUR
4. сформировать перечень документов которые были проведены и формируют остатки для 6S результат отработки запроса SR_6SX_PAY_template.sql
5. можешь свободно редактировать скрипт SR_6SX_PAY_template.sql, в случае необходимости, сохраняя только перечень возвращаемых полей
6. подумай над вопросом как модифицировать скрипт SR_6SX_PAY_template.sql что бы в выходных данных нормально отрабатывалась substr(:data_acc, 1, 4) AS R020,

**Выходные данные:**
- резльтаты отработки запроса SR_6SX_PAY_template.sql записываются в файл excel из котрого вызван скрипт в таблицу с именем t6S_PAY, на листе 6SX_ACC - используй процедуру записи в таблицу paste_to_excel_smart

**Логирование:**
- допускается формирование логов, условие - логи в случае необходимости могут быть просто отключены

**Размещение:**
- скрипт долже быть в одном модуле с именем "pay_6sx" размещай в fetchers
- лог размещай в logs

**Рекомендации:**
- для понимания структуры данных прочитай файлы SR_6SX_PAY_template.sql и SR_6SX_ACCOUNT_template.sql
- скрипт должен быть компактным и быстрым, добавляй в код комментарии на русском
- в случае возникновения вопросов или уточнения обязательно спрашивай меня