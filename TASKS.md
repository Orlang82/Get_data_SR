## Задача: формирование и контроль перечня счетов для 6S

**Цель:** получить перечни счетов которые будут использоватьс при формировании 6S, обработать их согласно условиям, вернуть данные в excel с форматированием.

**Входные данные:**
- Файл: SR_6SX_EXCLUDE_template.sql - будет возвращать перечень счетов которые уже исключены из 6SX
- Файл: SR_6SX_ACCOUNT_template.sql - возращает перечень счетов с остатками которые сформировались на текущий день, и по которыем неоходимо провести анализ.
- дата которая будет получена из excel и является отчетной датой.

**Первоначальные действия:**
1. получить отчетную дату из excel из которого запущен скрипт, дата берется из именованной ячейки RDATE на листе menu
2. сформировать перечень счетов которые уже исключены из рачета 6SX результат отработки запроса SR_6SX_EXCLUDE_template.sql, можно использовать поле ID или ACCOUNT_NUMBER
3. сформировать перечень счетов с остатками которые сформировались на текущий день результат отработки запроса SR_6SX_ACCOUNT_template.sql

**Логика обработки:**
1. Анализируем результат отработки запроса SR_6SX_ACCOUNT_template.sql, если в записях по полю CUR присутствует код 980 то эти счета помечаются как exclude
2. Анализируем результат отработки запроса SR_6SX_ACCOUNT_template.sql, если поле NAME_ACC содержит компонент "транз", "транс" регистр может быть любым, то помечаются как exclude
3. Анализируем результат отработки запроса SR_6SX_EXCLUDE_template.sql, производится сравнение полученного перечня счетов с перечнем полученным из запроса SR_6SX_ACCOUNT_template.sql если есть совпадения то помечаются как pre_excluded
4. формируется два списка acc_exclude он сожержит записи которые помечены как exclude и pre_excluded и acc_calc содержит записи которые не помечены как exclude и pre_excluded

**Выходные данные:**
- резльтаты списка acc_calc записываются в файл excel из котрого вызван скрипт в таблицу с именем t6S_TO_CALC, поля которые записываются R020, ACCOUNT_NUMBER, CUR, SUM_UAH, NAME_ACC - используй процедуру записи в таблицу paste_to_excel_smart
- резльтаты списка acc_exclude записываются в файл excel из котрого вызван скрипт в таблицу с именем t6S_EXCLUDE, поля которые записываются R020, ACCOUNT_NUMBER, CUR, SUM_UAH, NAME_ACC - используй процедуру записи в таблицу paste_to_excel_smart
- записи в таблице t6S_EXCLUDE должны быть отформатированы следующим образом: записи которые были ранее помечены как pre_excluded - цвет шрифта серый 35% и формат текста "зачеркнутый"; записи которые были ранее помечены как exclude - цвет шрифта красный и формат текста "полужирный";

**Логирование:**
- допускается формирование логов, условие - логи в случае необходимости могут быть просто отключены

**Размещение:**
- скрипт долже быть в одном модуле с именем "detail_6sx" размещай в fetchers
- лог размещай в logs

**Рекомендации:**
- по вопросу работы с excel, форматирования текста используй context7
- для понимания структуры данных прочитай файлы SR_6SX_EXCLUDE_template.sql и SR_6SX_ACCOUNT_template.sql
- скрипт должен быть компактным и быстрым, добавляй в код комментарии на русском