WITH ACC_FILTER AS (
    SELECT COLUMN_VALUE AS R020
    FROM TABLE(SYS.ODCINUMBERLIST(
        1811, 1819, 2800, 2801, 3540, 3541, 3548, 9200, 9201, 9202, 9203, 9204, 
        9206, 9207, 9208, 9221, 9224, 9227, 9228, 9300, 9321, 9324, 9327, 9328, 
        9350, 9351, 9352, 9353, 9354, 9356, 9357, 9358, 9359
    ))
)
SELECT
    a.ID,
    SUBSTR(a.ACCOUNT_NUMBER, 1, 4) AS R020,
    a.ACCOUNT_NUMBER,
    c.CODE AS CUR,
    asp.BASE_AMOUNT AS SUM_UAH,
    a.NAME AS NAME_ACC
FROM SR_BANK.ACCOUNT_SNAPSHOT asp
INNER JOIN SR_BANK.ACCOUNT a
    ON asp.ACCOUNT_ID = a.ID
    AND a.IS_OPEN = 'T'
    AND a.AMOUNT_TYPE = 'A'
INNER JOIN ACC_FILTER af
    ON TO_NUMBER(SUBSTR(a.ACCOUNT_NUMBER, 1, 4)) = af.R020
INNER JOIN SR_BANK.CURRENCY c
    ON a.CURRENCY_ID = c.ID
WHERE asp.SNAPSHOT_DATE = TO_DATE(:date_param, 'dd.mm.yyyy')
  AND asp.BASE_AMOUNT <> 0
ORDER BY SUBSTR(a.ACCOUNT_NUMBER, 1, 4)